/*
* Architect v0.0.7
* http://architectjs.org
*
* Copyright 2013, Etienne Lemay http://heliom.ca
* Released under MIT license
*
* Date: 2013-08-06 13:33:38 -0400
*/
!(function(){this.a={}}).call(this),function(){this.a.Worker=function(){function t(){this.callbacks={},this.callbacksQueue={}}return t.prototype.addEventListener=function(t,r){var e;return this.callbacks[t]=r,(e=this.callbacksQueue[t])?(delete this.callbacksQueue[t],this.dispatch(t,e)):void 0},t.prototype.dispatch=function(t,r){return this.callbacks[t]?this.callbacks[t]({data:r}):this.callbacksQueue[t]=r},t.prototype.handleRequest=function(t){return this.dispatch("message",t)},t.prototype.terminate=function(){},t}()}.call(this),function(){var t,r={}.hasOwnProperty,e=function(t,e){function i(){this.constructor=t}for(var n in e)r.call(e,n)&&(t[n]=e[n]);return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t};this.a.ProxyWorker=function(r){function i(){return t=i.__super__.constructor.apply(this,arguments)}return e(i,r),i.prototype.postMessage=function(t){return this.handleRequest(t)},i}(this.a.Worker)}.call(this),function(){var t,r,e,i=this;this.a.SUPPORT_WORKER=!!window.Worker,this.a.WORKERS={proxy:{polyfill:this.a.ProxyWorker,workerPath:"_S/architect/proxy_worker.min.js"}},t=function(t){return this.a.workersPath?""+this.a.workersPath+"/"+t+"_worker.min.js":this.a.WORKERS[t].workerPath},e=function(r){return this.a.SUPPORT_WORKER?new Worker(t(r)):new this.a.WORKERS[r].polyfill},this.a.setupWorkersPath=function(t){return i.a.workersPath=t.replace(/\/$/,"")},this.a.work=function(t,r,i){var n;return n=e(r),n.postMessage(t),n.addEventListener("message",function(t){return n.terminate(),i(t.data)})},this.a.proxy=function(t,r){return i.a.work(t,"proxy",r)},r={},this.a.workOn=function(t,i,n,c){var o,s,h=this;return this.workOnCallback=c,o=!!r[t],s=r[t]||(r[t]=e(n)),s.postMessage(i),o?void 0:s.addEventListener("message",function(t){return h.workOnCallback(t.data)})},this.a.endJob=function(t){var e;return(e=r[t])?(e.terminate(),delete r[t]):void 0},this.a.proxyOn=function(t,r,e){return i.a.workOn(t,r,"proxy",e)},this.a.workFrom=function(t,r,e,n){var c;return null==e&&(e=null),void 0===n&&(n=e,e=null),i.a.SUPPORT_WORKER?(c=new Worker(t),c.postMessage(r),c.addEventListener("message",function(t){return c.terminate(),n(t.data)})):e?n(e(r)):console.warn("No fallback provided for "+t)}}.call(this);